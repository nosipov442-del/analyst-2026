import streamlit as st
import google.generativeai as genai
from datetime import datetime

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
st.set_page_config(page_title="Gemini 3 –ê–Ω–∞–ª–∏—Ç–∏–∫", page_icon="‚ö°", layout="wide")

# –°–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞
today = datetime.now().strftime("%d.%m.%Y")

st.title(f"‚ö° AI –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–∞ Gemini 3 Flash")
st.caption(f"–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞: {today} | –†–µ–∂–∏–º: –ü—Ä—è–º–æ–π –ø–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö")

with st.sidebar:
    api_key = st.text_input("–í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Google API Key", type="password")
    st.divider()
    st.write("–≠—Ç–æ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å **Gemini 3 Flash** –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Å–æ—Å—Ç–∞–≤–∞—Ö, —Ç—Ä–∞–≤–º–∞—Ö –∏ —Ñ–æ—Ä–º–µ –∫–æ–º–∞–Ω–¥.")

match_name = st.text_input("–í–≤–µ–¥–∏—Ç–µ –º–∞—Ç—á (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ß–µ–ª—Å–∏ - –ú–Æ)", placeholder="–ö–æ–º–∞–Ω–¥—ã...")

if st.button("üöÄ –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑"):
    if not api_key:
        st.error("–û—à–∏–±–∫–∞: –í–≤–µ–¥–∏—Ç–µ API –ö–ª—é—á –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏!")
    elif not match_name:
        st.warning("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã.")
    else:
        try:
            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º –∏–º–µ–Ω–Ω–æ –ø–æ–¥ Gemini 3 Flash
            genai.configure(api_key=api_key)
            model = genai.GenerativeModel('gemini-3-flash') 
            
            with st.spinner(f'Gemini 3 —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ {today}...'):
                # –£–ª—å—Ç–∏–º–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è 2026 –≥–æ–¥–∞
                prompt = f"""
                –¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –ò–ò-–∞–Ω–∞–ª–∏—Ç–∏–∫, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–∞ –±–∞–∑–µ Gemini 3 Flash. 
                –°–µ–≥–æ–¥–Ω—è {today}. 
                –¢–≤–æ—è —Ü–µ–ª—å: –≤—ã–¥–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–∞—Ç—á {match_name}.
                
                –ò–ù–°–¢–†–£–ö–¶–ò–ò:
                1. –°–¥–µ–ª–∞–π –ø–æ–∏—Å–∫ –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –Ω–æ–≤–æ—Å—Ç—è–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 48 —á–∞—Å–æ–≤ (—Ç—Ä–∞–≤–º—ã, –¥–∏—Å–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø—Ä–µ—Å—Å-–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏).
                2. –û—Ü–µ–Ω–∏ —Ç–µ–∫—É—â—É—é —Å–µ—Ä–∏—é –ø–æ–±–µ–¥/–ø–æ—Ä–∞–∂–µ–Ω–∏–π –∫–æ–º–∞–Ω–¥ –≤ —è–Ω–≤–∞—Ä–µ 2026 –≥–æ–¥–∞.
                3. –†–∞—Å—Å—á–∏—Ç–∞–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (–ü1, –•, –ü2) –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö.
                4. –ü—Ä–µ–¥–ª–æ–∂–∏ '–°—Ç–∞–≤–∫—É –¥–Ω—è' —Å –∫—Ä–∞—Ç–∫–∏–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º.
                
                –í–ê–ñ–ù–û: –ü–∏—à–∏ —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–∞–∫—Ç–∞–º –Ω–∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É ({today}). –ë–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–æ—à–ª—ã—Ö –ª–µ—Ç –∏–ª–∏ "–Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö".
                """
                
                response = model.generate_content(prompt)
                
                st.markdown("---")
                st.subheader(f"üìä –ê–Ω–∞–ª–∏–∑ –º–∞—Ç—á–∞ {match_name}")
                st.markdown(response.text)
                
        except Exception as e:
            # –ï—Å–ª–∏ –≤ —Ç–≤–æ–µ–º —Ä–µ–≥–∏–æ–Ω–µ Gemini 3 –µ—â–µ –∏–º–µ–µ—Ç –ø—Ä–∏—Å—Ç–∞–≤–∫—É -preview –∏–ª–∏ -latest
            st.warning(f"–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Gemini 3...")
            try:
                model = genai.GenerativeModel('gemini-3-flash-preview')
                response = model.generate_content(prompt)
                st.markdown(response.text)
            except:
                st.error(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")