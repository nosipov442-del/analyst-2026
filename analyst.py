import streamlit as st
import google.generativeai as genai
from datetime import datetime

# --- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã ---
st.set_page_config(page_title="AI Analyst 2026", page_icon="‚öΩ", layout="wide")

# –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
today_date = datetime.now().strftime("%d.%m.%Y")

st.title(f"üèÜ –°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –ò–ò-–ê–Ω–∞–ª–∏—Ç–∏–∫")
st.write(f"–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Gemini 3 Flash | –°–µ–≥–æ–¥–Ω—è: {today_date}")

# --- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å ---
with st.sidebar:
    st.header("–ù–∞—Å—Ç—Ä–æ–π–∫–∏")
    api_key = st.text_input("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Google API Key", type="password")
    st.markdown("---")
    st.info("–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 0 (–¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç)\n–ü–æ–∏—Å–∫: –í–∫–ª—é—á–µ–Ω")

# --- –ü–æ–ª–µ –≤–≤–æ–¥–∞ ---
match_input = st.text_input("–í–≤–µ–¥–∏—Ç–µ –º–∞—Ç—á –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:", placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–µ–∞–ª –ú–∞–¥—Ä–∏–¥ - –ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏")

# --- –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ ---
if st.button("üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –ê–ù–ê–õ–ò–ó"):
    if not api_key:
        st.error("–û—à–∏–±–∫–∞: –í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏!")
    elif not match_input:
        st.warning("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥.")
    else:
        try:
            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API
            genai.configure(api_key=api_key)
            
            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏ (—É–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤)
            generation_config = {
                "temperature": 0,
                "top_p": 0.95,
                "max_output_tokens": 8192,
            }

            model = genai.GenerativeModel(
                model_name='gemini-3-flash',
                generation_config=generation_config
            )
            
            with st.spinner('–ò–ò —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É...'):
                # –ü—Ä–æ–º–ø—Ç –±–µ–∑ –ª–∏—à–Ω–∏—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏
                prompt = f"""–°–µ–≥–æ–¥–Ω—è {today_date}. –¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫.
–ü—Ä–æ–≤–µ–¥–∏ –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–∞—Ç—á–∞: {match_input}.

–¢–≤–æ–∏ –∑–∞–¥–∞—á–∏:
1. –ò—Å–ø–æ–ª—å–∑—É–π –ø–æ–∏—Å–∫, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–∞–≤—ã –∏ —Ç—Ä–∞–≤–º—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.
2. –û—Ü–µ–Ω–∏ —Ñ–æ—Ä–º—É –∫–æ–º–∞–Ω–¥ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ (—è–Ω–≤–∞—Ä—å 2026).
3. –†–∞—Å—Å—á–∏—Ç–∞–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ü1/X/–ü2 –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö.
4. –ü—Ä–µ–¥–ª–æ–∂–∏ —Ç–æ—á–Ω—ã–π —Å—á–µ—Ç –∏ –ª—É—á—à—É—é —Å—Ç–∞–≤–∫—É.

